---
title: "[ì½”ë”©ì •ë³µğŸ®] ì—ëŸ¬ ë…¸íŠ¸"
date: 2020-09-07
tags: code
---

## ë“¤ì–´ê°€ê¸°ì— ì•ì„œ
ì½”ë”© ì…ë¬¸ìì¸ ë‚˜ëŠ” ë§¤ì¼ ê°™ì´ ìˆ˜ë„ ì—†ì´ ë§ì€ ì—ëŸ¬ë¥¼ ë§ˆì£¼ì¹œë‹¤. ë¬¼ë¡  ìƒˆë¡œìš´ ì‘ì—…ì„ í•  ë•ŒëŠ” ìƒˆë¡œìš´ ì—ëŸ¬ë¥¼ ë§Œë‚˜ëŠ” í¸ì´ì§€ë§Œ ê³¼ê±°ì— ë³´ì•˜ë˜ ê°™ì€ ì—ëŸ¬ë¥¼ ë˜ ë‹¤ì‹œ ë§ŒëŠ” ê²½ìš°ë„ ìˆë‹¤. ì´ëŸ´ ë•Œ ê°™ì€ ì‹¤ìˆ˜ë¥¼ ë°˜ë³µí•˜ì§€ ì•Šê³  ë¹ ë¥´ê²Œ í•´ê²°í•  ìˆ˜ ìˆë„ë¡ ë¯¸ë˜ì˜ ë‚˜ë¥¼ ìœ„í•´ ë§Œë‚¬ë˜ ì—ëŸ¬ë“¤ì„ ì—¬ê¸°ì— ê¸°ë¡í•´ ë‘ë ¤ê³  í•œë‹¤.

í•´ë‹¹ ì—ëŸ¬ì˜ ì œëª©ì€ ëª©ì°¨ë¡œ ì •ë¦¬ë¨ìœ¼ë¡œ ë²ˆí˜¸ë¥¼ ë¶™ì´ì§€ ì•Šê³ , í˜„ìƒ/í•´ê²° ê³¼ì •/ê²°ë¡ (+ì¶œì²˜)ì—ë§Œ ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì†ì ìœ¼ë¡œ ì •ë¦¬í•  ê³„íšì´ë‹¤. ì¼ì • ìˆ˜ì¤€ ì´ìƒì˜ ì—ëŸ¬ë¥¼ ê¸°ë¡í•˜ë©´ ì¦ìƒ ë³„ë¡œ ë‹¤ì‹œ ì •ë¦¬í•  ê²ƒì´ë‹¤. ~~ë¬¼ë¡  ê·¸ ë§Œí¼ ìŒ“ì¼ ì •ë„ë¡œ ì„±ì‹¤í•˜ê²Œ í¬ìŠ¤íŒ…í•  ìˆ˜ ìˆì„ ì§€ëŠ” ë¯¸ì§€ìˆ˜~~

## ì½”ë©ì—ì„œ í•œê¸€ ê¹¨ì§ ì—ëŸ¬
### 1. í˜„ìƒ
í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ ë‹¤ìŒê³¼ ê°™ì´ ì½”ë©ì—ì„œ í•œê¸€ë¡œ ì‘ì„±ëœ txt íŒŒì¼ì„ ë¶ˆëŸ¬ì™”ëŠ”ë° ëª½ë•… ê¹¨ì ¸ìˆì—ˆë‹¤ ã… ã… 

![ì½”ë© í•œê¸€ ê¹¨ì§ í˜„ìƒ](/assets/ì½”ë©%20í•œê¸€%20ê¹¨ì§%20í˜„ìƒ.PNG)

### 2. í•´ê²° ê³¼ì •

[ì—¬ê¸°](https://teddylee777.github.io/pandas/%EA%B3%B5%EA%B3%B5%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%95%9C%EA%B8%80%EA%B9%A8%EC%A7%90%ED%98%84%EC%83%81-%ED%95%B4%EA%B2%B0%EB%B0%A9%EB%B2%95)ë¥¼ ìš°ì„  ì°¸ê³  í•˜ì˜€ë‹¤.

ì—‘ì…€ íŒŒì¼ì—ì„œ ì—´ì‹¬íˆ ì¸ì½”ë”©ì„ ë³€ê²½í•´ë³´ì•˜ìœ¼ë‚˜ í•´ê²°ë˜ì§€ ì•Šì•˜ë‹¤. ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ í•´ë³´ë˜ ë„ì¤‘ í•´ê²° ë°©ë²•ì€ ìƒê°ë³´ë‹¤ ë‹¨ìˆœí–ˆë‹¤. txt íŒŒì¼ì˜ ì¸ì½”ë”©ì„ ë°”ê¿”ì£¼ê³ !! ì½”ë©ì— ì—…ë¡œë“œí•˜ë©´ ëë˜ ê²ƒì´ë‹¤!

![í…ìŠ¤íŠ¸-íŒŒì¼-ì¸ì½”ë”©-ë³€ê²½](/assets/í…ìŠ¤íŠ¸-íŒŒì¼-ì¸ì½”ë”©-ë³€ê²½.PNG)

### 3. ê²°ë¡ ê³¼ ì¶œì²˜

- ì¸ì½”ë”©ì„ ë³€ê²½í•˜ëŠ” ë°©ë²•ì€ ë‹¤ì–‘í•˜ë‹¤: ì—‘ì…€ì—ì„œ "ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°"ì—ì„œ ë³€ê²½ / ì—‘ì…€ì—ì„œ "ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì €ì¥" / í…ìŠ¤íŠ¸ íŒŒì¼ì—ì„œ ì§ì ‘ ì¸ì½”ë”© ë³€ê²½
- https://teddylee777.github.io/pandas/%EA%B3%B5%EA%B3%B5%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%95%9C%EA%B8%80%EA%B9%A8%EC%A7%90%ED%98%84%EC%83%81-%ED%95%B4%EA%B2%B0%EB%B0%A9%EB%B2%95


## ì½”ë©ì—ì„œ RuntimeError: CUDA error: device-side assert triggered

### 1. í˜„ìƒ

KcBERTë¥¼ fine-tuning í•˜ëŠ” ì¤‘ ì˜ˆì œ ì½”ë© íŒŒì¼ì—ì„œ ë°ì´í„°ì…‹ë§Œ ë°”ê¿¨ì„ ë¿ì¸ë° ìœ„ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆë‹¤.

### 2. í•´ê²° ê³¼ì •

[í•œê¸€ ë¸”ë¡œê·¸](https://brstar96.github.io/shoveling/device_error_summary/)ë¥¼ ì°¾ì„ ìˆ˜ ìˆì—ˆëŠ”ë°, ë ˆì´ë¸” ì‹œì‘ì„ 0ìœ¼ë¡œ í•˜ëŠ” ë“± ì—¬ëŸ¬ê°€ì§€ë¥¼ ì‹œë„í–ˆìœ¼ë‚˜ í•´ê²°í•˜ì§€ ëª»í–ˆë‹¤.

[ì—¬ê¸°](https://stackoverflow.com/questions/53268442/pytorch-runtimeerror-cuda-error-device-side-assert-triggered)ì—ì„œ ì½”ë©ì˜ runtime typeì„ Noneìœ¼ë¡œ í•˜ë©´ ì‹¤ì œ ì–´ë–¤ ê²ƒì´ ë¬¸ì œê°€ ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤.

> Switch Hardware Accelerator Type to `None` under `Runtime`->`Change Runtime Type`. This should give you a more meaningful error message.

`None`ìœ¼ë¡œ ë³€ê²½í•˜ê³  ë‹¤ì‹œ ëŒë ¤ë³´ë‹ˆ ì—ëŸ¬ê°€ ë‹¬ë¼ì ¸ ìˆì—ˆë‹¤.

`IndexError: Target 2 is out of bounds.`

ê·¸ë˜ì„œ ê³§ë°”ë¡œ í•´ë‹¹ ì—ëŸ¬ì˜ ì›ì¸ì„ ì°¾ì•„ë³´ì•˜ë‹¤.

[ì—¬ê¸°](https://discuss.pytorch.org/t/indexerror-target-2-is-out-of-bounds/69614)ë¥¼ ì‚´í´ë³´ë‹ˆ target í¬ê¸°ì˜ ë¬¸ì œì¸ ê²ƒ ê°™ë‹¤.

[KcBERT ê¹ƒí—ˆë¸Œ](https://github.com/Beomi/KcBERT/issues/3)ì— ì´ìŠˆë¡œ ì—¬ì­¤ë³´ë‹ˆ `BertForSequenceClassification`ì€ ê¸°ë³¸ì ìœ¼ë¡œ `num_label=2` ë¼ëŠ” ì˜µì…˜ì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì—, `num_label=5`ë¡œ ì§€ì •í•´ì¤˜ì•¼í•œë‹¤ê³  í•œë‹¤.

í•´ë‹¹ ì˜µì…˜ì„ ì ì ˆíˆ ì¶”ê°€í•œ í›„ ë§Œë‚œ ì—ëŸ¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

`RuntimeError: Error(s) in loading state_dict for BertForSequenceClassification`

ì´ë²ˆì—ë„ ê²€ìƒ‰í•´ë³´ì. ì‚¬ì‹¤ ì´ê±´ ë‹¤ë¥¸ ì¼ê³¼ ë™ì‹œì— í•˜ë‹¤ë³´ë‹ˆ ì–´ë–»ê²Œ í•´ê²°í–ˆëŠ”ì§€ ê¹Œë¨¹ì—ˆë‹¤. ~~ë¯¸ë˜ì˜ ë‚˜, ë¯¸ì•ˆ~~ ì•„ë§ˆë„ metricê°€ default ê°’ì¸ binaryë¡œ ì„¤ì •ë˜ì–´ ìˆì–´ì„œ, ì ì ˆí•˜ê²Œ ë°”ê¿”ì£¼ë‹ˆ ì ì–´ë„ ìœ„ì˜ ì—ëŸ¬ëŠ” ì‚¬ë¼ì¡Œë˜ ê²ƒ ê°™ë‹¤ ã…ã…

ê·¸ëŸ¬ì ë˜ ë‹¤ë¥¸ ì—ëŸ¬ê°€ ì°¾ì•„ì˜´..

`RuntimeError: DataLoader worker (pid 1619) is killed by signal: Killed.`

[ì—¬ê¸°](https://github.com/pytorch/pytorch/issues/8976)ì—ì„œ í•´ë‹µì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤.

> You can try running with num_workers=0 and see if it gives you a better error (as it doesn't use subprocesses).

ì´ë ‡ê²Œ `num_workers=0`ìœ¼ë¡œ ì„¸íŒ…í•˜ë‹ˆ ë“œë””ì–´ í•™ìŠµì´ ì‹œì‘ë˜ì—ˆë‹¤!! í•˜ì§€ë§Œ ì´ê²Œ ê³¼ì—° multi processing ì…ì¥ì—ì„œ ì¢‹ì€ ë°©ë²•ì¸ì§€ëŠ” ëª¨ë¥´ê² ë‹¤. ìš°ì„  ì œí•œëœ ì‹œê°„ì´ê¸° ë•Œë¬¸ì— ë¹ ë¥´ê²Œ ë„˜ì–´ê°€ì!

### 3. ê²°ë¡ ê³¼ ì¶œì²˜

- https://stackoverflow.com/questions/53268442/pytorch-runtimeerror-cuda-error-device-side-assert-triggere
- https://discuss.pytorch.org/t/indexerror-target-2-is-out-of-bounds/69614
- https://github.com/Beomi/KcBERT/issues/3
- https://github.com/pytorch/pytorch/issues/8976
